<div class="container mt-4">
  <div class="card">
    <div class="card-header bg-primary text-white">
      <h2 class="mb-0">Edit Contract</h2>
    </div>
    <div class="card-body">
      <%= form_with(model: @agreement_contract, local: true) do |f| %>
        <% if @agreement_contract.errors.any? %>
          <div class="alert alert-danger" role="alert">
            <h4><%= pluralize(@agreement_contract.errors.count, "error") %> prohibited this contract from being saved:</h4>
            <ul class="mb-0">
              <% @agreement_contract.errors.each do |error| %>
                <li><%= error.full_message %></li>
              <% end %>
            </ul>
          </div>
        <% end %>

        <div class="row">
          <div class="col-md-6">
            <div class="field mb-3">
              <%= f.label :contractable_type, "Contract Type", class: "form-label fw-bold" %>
              <%= f.select :contractable_type,
                    options_for_select([
                      ["Cooperative", "Cooperative"],
                      ["Individual", "Individual"]
                    ], @agreement_contract.contractable_type),
                    { prompt: "Select contract type" },
                    { id: "contractable_type_select", class: "form-select" } %>
              <small class="form-text text-muted">Choose whether this contract is for a cooperative or individual</small>
            </div>

            <div class="field mb-3" id="cooperative_field" style="display: none;">
              <%= f.label :contractable_id, "Cooperative", class: "form-label fw-bold" %>
              <%= f.select :contractable_id,
                    options_from_collection_for_select(@cooperatives, :id, :name, @agreement_contract.contractable_id),
                    { prompt: "Select a cooperative" },
                    { id: "cooperative_select", class: "tom-select" } %>
              <small class="form-text text-muted">Choose the cooperative for this contract</small>
            </div>

            <div class="field mb-3" id="individual_field" style="display: none;">
              <%= f.label :contractable_id, "Individual", class: "form-label fw-bold" %>
              <%= f.select :contractable_id,
                    options_from_collection_for_select(@individuals, :id, :full_name, @agreement_contract.contractable_id),
                    { prompt: "Select an individual" },
                    { id: "individual_select", class: "tom-select" } %>
              <small class="form-text text-muted">Choose the individual for this contract</small>
            </div>
          </div>

          <div class="col-md-6">
            <div class="field mb-3">
              <%= f.label :insurance_product_id, "Insurance Product", class: "form-label fw-bold" %>
              <%= f.select :insurance_product_id,
                    options_from_collection_for_select(@products, :id, :name, @agreement_contract.insurance_product_id),
                    { prompt: "Select a product" },
                    { id: "product_select", class: "tom-select" } %>
              <small class="form-text text-muted">Select the insurance product for this contract</small>
            </div>
          </div>
        </div>

        <div class="mt-4">
          <%= f.submit "Update Contract", class: "btn btn-primary" %>
          <%= link_to "Cancel", agreement_contracts_path, class: "btn btn-tertiary" %>
        </div>
      <% end %>
    </div>
  </div>

  <div class="mt-3">
    <%= link_to "â† Back to contracts", agreement_contracts_path, class: "text-decoration-none" %>
  </div>
</div>